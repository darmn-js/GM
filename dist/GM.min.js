!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("src/util/api"),require("src/util/ui")):"function"==typeof define&&define.amd?define(["exports","src/util/api","src/util/ui"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).GM={},e.API,e.UI)}(this,(function(e,t,a){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=n(t),r=n(a);e.couchHandler=class{constructor(e,t,a={}){let{couchDB:n={url:"https://gat.mylims.org/roc",database:"eln",kind:"sample"},reference:i}=a;this.reference=i,this.targetReference=i.split(" ")[0],this.couchDB=n,this.roc=t,this.sample=e}updateSample(e){this.sample=e}getToc(e,t){const a=this.targetReference;this.roc.query(e).then((function(e){e=e.filter((e=>e.value.reference.split(" ")[0]===a)),i.default.createData(t,e)}))}loadSampleFeatures(e,t){const{showNotification:a=!0}=t,n=this.sample.sample.$content,s=this.getParentKind()===e?n.general.metadata.sampleIdentifier:"This field must be replace it";i.default.createData("content",n),i.default.createData("sampleIdentifier",s),a&&r.default.showNotification("Updated current sample","success")}async createSample(e,t,a,n){const s=this.roc;r.default.confirm(`<div> Are you sure to save: ${a}? </div>`).then((function(r){if(!r)return;e.$id=[n,a],e.$content.general.kind=t,r.sample&&e.$id.push(r.sample);let c=i.default.cache("userInfo");c&&(e.$owners=[c.email]),s.create(e),i.default.doAction("updateSamples")}))}getJSONTemplate(){const e={$type:"entry",$id:["reference","batchID"],$kind:"sample",$owners:["admin@cheminfo.org"],$content:"",$lastModification:"admin@cheminfo.org",$modificationDate:"",$creationDate:""};return e.$content=this.sample.sample.$content,e.$content.image=[],e.$content.spectra={},e.$content.general.metadata.parent=this.getParent(),e.$content.general.metadata.sampleIdentifier=i.default.getData("sampleIdentifier").resurrect(),e}getParentKind(){return this.sample.sample.$content.general.kind}getParent(){const e=this.sample.sample;return{reference:e.$id[0],batch:e.$id[1],uuid:e._id}}builtSampleBatch(){return`${i.default.getData("sampleIdentifier").resurrect()}`}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=GM.min.js.map
